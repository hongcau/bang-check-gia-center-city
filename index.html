<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√¥ng c·ª• Tra c·ª©u & T√≠nh l√£i su·∫•t B·∫•t ƒê·ªông S·∫£n</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        .card { transition: all 0.3s ease; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
    </style>
</head>
<body>

    <div class="max-w-6xl mx-auto p-4">
        <header class="text-center py-8">
            <h1 class="text-3xl font-bold text-blue-900 mb-2">TRA C·ª®U GI√Å & D·ª∞ TO√ÅN TR·∫¢ G√ìP</h1>
            <p class="text-gray-600">D·ªØ li·ªáu c·∫≠p nh·∫≠t: BCONS CENTER CITY</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <div class="lg:col-span-2 space-y-6">
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                        üîç T√¨m ki·∫øm cƒÉn h·ªô
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <input type="text" id="searchCode" placeholder="Nh·∫≠p m√£ cƒÉn (VD: C.01-01)" 
                               class="border p-2 rounded w-full focus:ring-2 focus:ring-blue-500 outline-none">
                        
                        <select id="filterBed" class="border p-2 rounded w-full">
                            <option value="">S·ªë ph√≤ng ng·ªß (T·∫•t c·∫£)</option>
                            <option value="1">1 Ph√≤ng ng·ªß</option>
                            <option value="2">2 Ph√≤ng ng·ªß</option>
                            <option value="3">3 Ph√≤ng ng·ªß</option>
                        </select>

                        <select id="filterView" class="border p-2 rounded w-full">
                            <option value="">H∆∞·ªõng View (T·∫•t c·∫£)</option>
                            <option value="ƒê√¥ng Nam">ƒê√¥ng Nam</option>
                            <option value="T√¢y B·∫Øc">T√¢y B·∫Øc</option>
                            <option value="ƒê√¥ng B·∫Øc">ƒê√¥ng B·∫Øc</option>
                            <option value="T√¢y Nam">T√¢y Nam</option>
                        </select>
                    </div>
                    <button onclick="filterData()" class="mt-4 w-full bg-blue-600 text-white py-2 rounded font-semibold hover:bg-blue-700 transition">
                        T√¨m ki·∫øm
                    </button>
                </div>

                <div id="resultsArea" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    </div>
            </div>

            <div class="lg:col-span-1">
                <div class="bg-white p-6 rounded-xl shadow-lg sticky top-6 border-t-4 border-yellow-500">
                    <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                        üí∏ D·ª± to√°n vay ng√¢n h√†ng
                    </h2>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm text-gray-600 mb-1">Gi√° tr·ªã cƒÉn h·ªô (VNƒê)</label>
                            <input type="text" id="loanPrice" value="0" class="w-full border p-2 rounded font-bold text-blue-900 bg-gray-50" onkeyup="formatCurrencyInput(this)">
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">T·ª∑ l·ªá vay (%)</label>
                                <select id="loanRatio" class="w-full border p-2 rounded">
                                    <option value="70">70%</option>
                                    <option value="50">50%</option>
                                    <option value="80">80%</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">Th·ªùi h·∫°n (NƒÉm)</label>
                                <input type="number" id="loanYears" value="20" class="w-full border p-2 rounded">
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm text-gray-600 mb-1">L√£i su·∫•t (%/nƒÉm)</label>
                            <input type="number" id="interestRate" value="8.5" step="0.1" class="w-full border p-2 rounded">
                        </div>

                        <button onclick="calculateLoan()" class="w-full bg-yellow-500 text-white py-2 rounded font-bold hover:bg-yellow-600 transition">
                            T√≠nh to√°n ngay
                        </button>

                        <div id="calcResult" class="hidden mt-4 pt-4 border-t border-gray-200">
                            <div class="flex justify-between text-sm mb-2">
                                <span class="text-gray-600">V·ªën t·ª± c√≥ (30%):</span>
                                <span class="font-bold" id="resSelfCapital">0</span>
                            </div>
                            <div class="flex justify-between text-sm mb-2">
                                <span class="text-gray-600">S·ªë ti·ªÅn vay:</span>
                                <span class="font-bold text-blue-600" id="resLoanAmount">0</span>
                            </div>
                            <div class="bg-blue-50 p-3 rounded text-center mt-2">
                                <p class="text-xs text-gray-500">Tr·∫£ trung b√¨nh h√†ng th√°ng (G·ªëc + L√£i)</p>
                                <p class="text-xl font-bold text-red-600" id="resMonthlyPay">0</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // D·ªÆ LI·ªÜU M·∫™U (L·∫•y t·ª´ file Excel c·ªßa b·∫°n: Sheet PTTT1)
        // B·∫°n c√≥ th·ªÉ th√™m h√†ng ng√†n d√≤ng v√†o ƒë√¢y sau khi chuy·ªÉn Excel sang JSON ho·∫∑c CSV
        const rawData = [
            { id: "C.01-01", area: 58.71, netArea: 52.58, bed: 2, bath: 1, view: "T√¢y B·∫Øc", price: 4549833168 },
            { id: "C.01-02", area: 65.68, netArea: 59.46, bed: 2, bath: 2, view: "T√¢y B·∫Øc", price: 5106780057 },
            { id: "C.01-03", area: 55.15, netArea: 50.73, bed: 2, bath: 1, view: "T√¢y B·∫Øc", price: 4422503747 },
            { id: "C.01-10", area: 84.25, netArea: 77.31, bed: 3, bath: 2, view: "ƒê√¥ng Nam", price: 7089085682 },
            { id: "C.01-15", area: 65.30, netArea: 60.47, bed: 2, bath: 2, view: "ƒê√¥ng Nam", price: 5662102587 },
            { id: "C.01-25", area: 60.50, netArea: 55.52, bed: 2, bath: 2, view: "ƒê√¥ng B·∫Øc", price: 4768389316 },
            { id: "C.01-26", area: 63.43, netArea: 58.17, bed: 2, bath: 2, view: "ƒê√¥ng B·∫Øc", price: 4995987149 },
            // ... B·∫°n c√≥ th·ªÉ copy th√™m d√≤ng t·ª´ Excel v√†o ƒë√¢y
        ];

        // 1. H√ÄM HI·ªÇN TH·ªä D·ªÆ LI·ªÜU RA M√ÄN H√åNH
        function renderData(data) {
            const container = document.getElementById('resultsArea');
            container.innerHTML = ''; // X√≥a c≈©

            if(data.length === 0) {
                container.innerHTML = '<p class="text-gray-500 italic p-4">Kh√¥ng t√¨m th·∫•y cƒÉn h·ªô ph√π h·ª£p.</p>';
                return;
            }

            data.forEach(item => {
                const priceFormatted = formatMoney(item.price);
                const html = `
                    <div class="card bg-white p-4 rounded-lg shadow border border-gray-100 flex flex-col justify-between">
                        <div>
                            <div class="flex justify-between items-start mb-2">
                                <span class="bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 rounded">${item.id}</span>
                                <span class="text-sm text-gray-500">${item.view}</span>
                            </div>
                            <h3 class="font-bold text-gray-800">${item.bed} PN - ${item.bath} WC</h3>
                            <div class="text-sm text-gray-600 mt-1">
                                DT Tim t∆∞·ªùng: <b>${item.area}m¬≤</b>
                            </div>
                            <div class="text-lg font-bold text-red-600 mt-2">
                                ${priceFormatted}
                            </div>
                        </div>
                        <button onclick="selectApartment(${item.price})" class="mt-4 w-full border border-blue-500 text-blue-600 py-1.5 rounded hover:bg-blue-50 text-sm font-semibold transition">
                            T√≠nh th·ª≠ tr·∫£ g√≥p
                        </button>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        // 2. H√ÄM L·ªåC D·ªÆ LI·ªÜU
        function filterData() {
            const code = document.getElementById('searchCode').value.toLowerCase();
            const bed = document.getElementById('filterBed').value;
            const view = document.getElementById('filterView').value;

            const filtered = rawData.filter(item => {
                const matchCode = item.id.toLowerCase().includes(code);
                // L∆∞u √Ω: D·ªØ li·ªáu m·∫´u bed l√† s·ªë (2), value input l√† string ("2") n√™n d√πng ==
                const matchBed = bed === "" || item.bed == bed; 
                const matchView = view === "" || item.view === view;
                return matchCode && matchBed && matchView;
            });

            renderData(filtered);
        }

        // 3. H√ÄM CH·ªåN CƒÇN H·ªò -> ƒê∆ØA GI√Å V√ÄO √î T√çNH
        function selectApartment(price) {
            document.getElementById('loanPrice').value = new Intl.NumberFormat('vi-VN').format(price);
            // Cu·ªôn m√†n h√¨nh l√™n √¥ t√≠nh (tr√™n mobile)
            if(window.innerWidth < 1024) {
                document.getElementById('loanPrice').scrollIntoView({behavior: "smooth"});
            }
            // T·ª± ƒë·ªông t√≠nh lu√¥n
            calculateLoan();
        }

        // 4. H√ÄM T√çNH L√ÉI SU·∫§T
        function calculateLoan() {
            // L·∫•y gi√° tr·ªã v√† x√≥a d·∫•u ch·∫•m/ph·∫©y
            let priceStr = document.getElementById('loanPrice').value.replace(/\./g, '').replace(/,/g, '');
            let price = parseFloat(priceStr);
            let ratio = parseFloat(document.getElementById('loanRatio').value) / 100;
            let years = parseFloat(document.getElementById('loanYears').value);
            let rate = parseFloat(document.getElementById('interestRate').value) / 100;

            if (isNaN(price) || price === 0) return;

            let loanAmount = price * ratio;
            let selfCapital = price - loanAmount;
            let months = years * 12;
            
            // T√≠nh tr·∫£ n·ª£ g·ªëc h√†ng th√°ng (ƒë·ªÅu)
            let monthlyPrincipal = loanAmount / months;
            // T√≠nh l√£i th√°ng ƒë·∫ßu ti√™n (cao nh·∫•t)
            let firstMonthInterest = (loanAmount * rate) / 12;
            let totalFirstMonth = monthlyPrincipal + firstMonthInterest;

            // Hi·ªÉn th·ªã k·∫øt qu·∫£
            document.getElementById('resSelfCapital').innerText = formatMoney(selfCapital);
            document.getElementById('resLoanAmount').innerText = formatMoney(loanAmount);
            document.getElementById('resMonthlyPay').innerText = formatMoney(totalFirstMonth) + "/th√°ng ƒë·∫ßu";
            
            document.getElementById('calcResult').classList.remove('hidden');
        }

        // Ti·ªán √≠ch: Format ti·ªÅn t·ªá VNƒê
        function formatMoney(amount) {
            return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(amount);
        }

        function formatCurrencyInput(input) {
            let value = input.value.replace(/\D/g, "");
            input.value = new Intl.NumberFormat('vi-VN').format(value);
        }

        // Kh·ªüi ch·∫°y l·∫ßn ƒë·∫ßu
        renderData(rawData);

    </script>
</body>
</html>
